<!DOCTYPE html>
<html>
<head>
    <title>éŸ³æ•ˆæ¸¬è©¦</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { 
            padding: 15px 30px; 
            margin: 10px; 
            font-size: 16px;
            cursor: pointer;
            border-radius: 8px;
            border: 2px solid #333;
            background: #007AFF;
            color: white;
        }
        .log { 
            margin-top: 20px; 
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ”Š éŸ³æ•ˆç³»çµ±æ¸¬è©¦</h1>
    
    <div>
        <button onclick="testInit()">1. åˆå§‹åŒ– AudioContext</button>
        <button onclick="testSimpleBeep()">2. æ¸¬è©¦ç°¡å–®å—¶è²</button>
        <button onclick="testError()">3. æ¸¬è©¦éŒ¯èª¤éŸ³æ•ˆ</button>
        <button onclick="checkStatus()">4. æª¢æŸ¥ç‹€æ…‹</button>
    </div>
    
    <div class="log" id="log">ç­‰å¾…æ¸¬è©¦...</div>

    <script>
        let audioContext = null;
        
        function log(msg) {
            const logDiv = document.getElementById('log');
            logDiv.textContent += '\n' + new Date().toLocaleTimeString() + ': ' + msg;
            console.log(msg);
        }
        
        async function testInit() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                log('âœ… AudioContext å‰µå»ºæˆåŠŸ');
                log('   ç‹€æ…‹: ' + audioContext.state);
                
                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                    log('   å·²æ¢å¾©, æ–°ç‹€æ…‹: ' + audioContext.state);
                }
            } catch (e) {
                log('âŒ å‰µå»ºå¤±æ•—: ' + e.message);
            }
        }
        
        function testSimpleBeep() {
            if (!audioContext) {
                log('âŒ è«‹å…ˆåˆå§‹åŒ– AudioContext');
                return;
            }
            
            try {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                osc.frequency.value = 800;
                gain.gain.value = 0.3;
                
                const now = audioContext.currentTime;
                osc.start(now);
                osc.stop(now + 0.2);
                
                log('âœ… æ’­æ”¾ 800Hz 0.2ç§’éŸ³æ•ˆ');
            } catch (e) {
                log('âŒ æ’­æ”¾å¤±æ•—: ' + e.message);
            }
        }
        
        function testError() {
            if (!audioContext) {
                log('âŒ è«‹å…ˆåˆå§‹åŒ– AudioContext');
                return;
            }
            
            try {
                // ä½éŸ³ 200Hz
                const osc1 = audioContext.createOscillator();
                const gain1 = audioContext.createGain();
                osc1.connect(gain1);
                gain1.connect(audioContext.destination);
                osc1.frequency.value = 200;
                gain1.gain.value = 0.3;
                const now = audioContext.currentTime;
                osc1.start(now);
                osc1.stop(now + 0.15);
                
                // æ›´ä½éŸ³ 150Hz
                const osc2 = audioContext.createOscillator();
                const gain2 = audioContext.createGain();
                osc2.connect(gain2);
                gain2.connect(audioContext.destination);
                osc2.frequency.value = 150;
                gain2.gain.value = 0.3;
                osc2.start(now + 0.15);
                osc2.stop(now + 0.35);
                
                log('âœ… æ’­æ”¾éŒ¯èª¤éŸ³æ•ˆ (200Hz + 150Hz)');
            } catch (e) {
                log('âŒ æ’­æ”¾å¤±æ•—: ' + e.message);
            }
        }
        
        function checkStatus() {
            if (!audioContext) {
                log('âš ï¸ AudioContext å°šæœªå‰µå»º');
                return;
            }
            
            log('ğŸ“Š AudioContext ç‹€æ…‹:');
            log('   state: ' + audioContext.state);
            log('   sampleRate: ' + audioContext.sampleRate);
            log('   currentTime: ' + audioContext.currentTime.toFixed(2));
            log('   baseLatency: ' + (audioContext.baseLatency || 'N/A'));
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æª¢æŸ¥
        window.addEventListener('load', () => {
            log('é é¢è¼‰å…¥å®Œæˆ');
            log('ç€è¦½å™¨: ' + navigator.userAgent);
        });
    </script>
</body>
</html>
